# Media session config file for PipeWire version "0.3.31" #
#
# Copy and edit this file in /etc/pipewire/media-session.d/
# for systemwide changes or in
# ~/.config/pipewire/media-session.d/ for local changes.

context.properties = {
    # Properties to configure the session and some
    # modules.
    #mem.mlock-all = false
    #support.dbus  = true
    #log.level     = 2
    #alsa.seq.name  = Midi-Bridge
}

context.spa-libs = {
    # Mapping from factory name to library.
    api.bluez5.*    = bluez5/libspa-bluez5
    api.alsa.*      = alsa/libspa-alsa
    api.v4l2.*      = v4l2/libspa-v4l2
    api.libcamera.* = libcamera/libspa-libcamera
}

context.modules = [
    #{   name = <module-name>
    #    [ args = { <key> = <value> ... } ]
    #    [ flags = [ [ ifexists ] [ nofail ] ]
    #}
    #
    # Loads a module with the given parameters.
    # If ifexists is given, the module is ignored when it is not found.
    # If nofail is given, module initialization failures are ignored.
    #
    # Uses RTKit to boost the data thread priority.
    {   name = libpipewire-module-rtkit
        args = {
            #nice.level   = -11
            #rt.prio      = 88
            #rt.time.soft = 200000
            #rt.time.hard = 200000
        }
        flags = [ ifexists nofail ]
    }

    # The native communication protocol.
    {   name = libpipewire-module-protocol-native }

    # Allows creating nodes that run in the context of the
    # client. Is used by all clients that want to provide
    # data to PipeWire.
    {   name = libpipewire-module-client-node }

    # Allows creating devices that run in the context of the
    # client. Is used by the session manager.
    {   name = libpipewire-module-client-device }

    # Makes a factory for wrapping nodes in an adapter with a
    # converter and resampler.
    {   name = libpipewire-module-adapter }

    # Allows applications to create metadata objects. It creates
    # a factory for Metadata objects.
    {   name = libpipewire-module-metadata }

    # Provides factories to make session manager objects.
    {   name = libpipewire-module-session-manager }

    # {   name = libpipewire-module-loopback
    #     args = {
    #         node.name = "UR242_Mic"
    #         node.description = "UR242 Microphone"
    #         capture.props = {
    #             audio.position = [ FR ]
    #             stream.dont-remix = true
    #             node.target = "alsa_input.usb-Yamaha_Corporation_Steinberg_UR242-00.pro-input-0"
    #             node.passive = true
    #         }
    #         playback.props = {
    #             media.class = "Audio/Source"
    #             audio.position = [ MONO ]
    #         }
    #     }
    # }
    # {   name = libpipewire-module-loopback
    #     args = {
    #         node.name = "UR242_Synth"
    #         node.description = "UR242 Synthesizer"
    #         capture.props = {
    #             audio.position = [ FL ]
    #             stream.dont-remix = true
    #             node.target = "alsa_input.usb-Yamaha_Corporation_Steinberg_UR242-00.pro-input-0"
    #             node.passive = true
    #         }
    #         playback.props = {
    #             media.class = "Audio/Source"
    #             audio.position = [ MONO ]
    #         }
    #     }
    # }
    # {   name = libpipewire-module-loopback
    #     args = {
    #         node.name = "UR242_Guitar"
    #         node.description = "UR242 Guitar"
    #         capture.props = {
    #             audio.position = [ RL RR ]
    #             stream.dont-remix = true
    #             node.target = "alsa_input.usb-Yamaha_Corporation_Steinberg_UR242-00.pro-input-0"
    #             node.passive = true
    #         }
    #         playback.props = {
    #             media.class = "Audio/Source"
    #             audio.position = [ FL FR ]
    #         }
    #     }
    # }
]

context.objects = [
   # {   factory = adapter
   #      args = {
   #          factory.name     = support.null-audio-sink
   #          node.name        = "Microphone"
   #          media.class      = Audio/Sink
   #          object.linger    = true
   #          audio.position   = [ FL FR ]
   #      }
   #  }
    # {   factory = adapter
    #     args = {
    #         factory.name     = support.null-audio-sink
    #         node.name        = "Teamspeak"
    #         media.class      = Audio/Source
    #         object.linger    = true
    #         audio.position   = [ FL FR ]
    #     }
    # }
]

session.modules = {
    # These are the modules that are enabled when a file with
    # the key name is found in the media-session.d config directory.
    # the default bundle is always enabled.

    default = [
        flatpak                 # manages flatpak access
        portal                  # manage portal permissions
        v4l2                    # video for linux udev detection
        #libcamera              # libcamera udev detection
        suspend-node            # suspend inactive nodes
        policy-node             # configure and link nodes
        #metadata               # export metadata API
        #default-nodes          # restore default nodes
        #default-profile        # restore default profiles
        #default-routes         # restore default route
        #streams-follow-default # move streams when default changes
        #alsa-seq               # alsa seq midi support
        #alsa-monitor           # alsa udev detection
        #bluez5                 # bluetooth support
        #restore-stream         # restore stream settings
        #logind                 # systemd-logind seat support
    ]
    with-audio = [
        metadata
        default-nodes
        default-profile
        default-routes
        alsa-seq
        alsa-monitor
    ]
    with-alsa = [
        with-audio
    ]
    with-jack = [
        with-audio
    ]
    with-pulseaudio = [
        with-audio
        bluez5
        logind
        restore-stream
        streams-follow-default
    ]
}
