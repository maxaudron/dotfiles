" Comment the following line if you don't want Vim and NeoVim to share the
" same plugin download directory.
let g:spacevim_plug_home = '~/.vim/plugged'

" Uncomment the following line to override the leader key. The default value is space key "<\Space>".
" let g:spacevim_leader = "<\Space>"

" Uncomment the following line to override the local leader key. The default value is comma ','.
" let g:spacevim_localleader = ','

" Enable the existing layers in space-vim.
" Refer to https://github.com/liuchengxu/space-vim/blob/master/layers/LAYERS.md for all available layers.
let g:spacevim_layers = [
      \ 'fzf', 'better-defaults', 'which-key',
      \ 'auto-completion',
      \ 'file-manager',
      \ 'latex',
      \ 'airline',
      \ 'git',
      \ 'better-motion',
      \ 'ctrlp',
      \ 'text-align',
      \ 'cscope',
      \ 'syntax-checking',
      \ 'deoplete',
      \ 'editing',
      \ 'programming',
      \ 'unite',
      \ 'lsp',
      \ 'go',
      \ 'haskell',
      \ 'python',
      \ 'docker',
      \ ]

" Uncomment the following line if your terminal(-emulator) supports true colors.
let g:spacevim_enable_true_color = 1
"let g:spacevim_lsp_engine = 'coc'

" Uncomment the following if you have some nerd font installed.
" let g:spacevim_nerd_fonts = 1

" If you want to have more control over the layer, try using Layer command.
" if g:spacevim.gui
"   Layer 'airline'
" endif

" Manage your own plugins.
" Refer to https://github.com/junegunn/vim-plug for more detials.
function! UserInit()

  " Add your own plugin via Plug command.
  Plug 'maxaudron/hybrid_darker.vim'
  Plug 'tpope/vim-fugitive'
  Plug 'chrisbra/Colorizer'
  Plug 'vimwiki/vimwiki'
  Plug 'tbabej/taskwiki'
  Plug 'majutsushi/tagbar'
  Plug 'lervag/vimtex'

endfunction

" Override the default settings from space-vim as well as adding extras
function! UserConfig()
  colorscheme hybrid_darker
  let g:airline_theme='hybrid_darker'
  let g:airline_highlighting_cache = 1
  let g:airline_powerline_fonts = 1
  let g:airline_left_sep = ' '
  let g:airline_right_sep = ' '
  let g:airline#extensions#tabline#left_sep = ' '
  let g:airline#extensions#tabline#left_alt_sep = ' '

  set mouse=a
  set noshowmode
  set undofile
  set undodir=~/.vim/undodir

  setlocal wrap! breakindent!

  set nocompatible
  filetype plugin on
  syntax on

  set tabstop=4
  set shiftwidth=4
  set expandtab
  set wrap linebreak nolist

  " Use deoplete.
  "let g:deoplete#enable_at_startup = 1

  " Linter
  let g:ale_linters = { 'javascript': ['eslint'] , 'python': ['flake8', 'prospector', 'vulture'] , 'haskell': ['hie'], 'go': ['go-fmt'], 'c': ['clangtidy'] }
  let g:ale_fixers = {'c': ['clang-format']}
  let g:ale_haskell_hie_executable = "hie-wrapper"
  let g:ale_go_bingo_executable = "bingo"
  let g:ale_open_list = 1
	let g:ale_set_loclist = 0
	let g:ale_set_quickfix = 1
  let g:ale_list_window_size = 4
  let g:ale_completion_enabled = 0
  let g:ale_lint_on_save = 1
  let g:ale_lint_on_text_changed = 1
  let g:ale_fix_on_save = 0

  let g:ale_sign_error = ''
  let g:ale_sign_warning = ''

  let g:pymode_python = 'python3'

  " let g:LanguageClient_serverCommands = {
      " \ 'languageServerHaskell': ['hie', '--lsp'],
      " \ }
  let g:LanguageClient_diagnosticsEnable = 0
  let g:LanguageClient_useVirtualText = 0

  nnoremap <Leader>el :copen<CR>

  " enable ncm2 for all buffers
  autocmd BufEnter * call ncm2#enable_for_buffer()

  " IMPORTANT: :help Ncm2PopupOpen for more information
  set completeopt=noinsert,menuone,noselect

  let g:vimwiki_folding = ''
  let g:vimwiki_conceallevel = 0
  let g:vimwiki_map_prefix = '<Leader>v'

  let g:vim_current_word#highlight_current_word = 0

	" let g:python_host_prog= expand($HOME) . "/.pyenv/versions/neovim2/bin/python"
  let g:python3_host_prog= expand($HOME) . "/.pyenv/versions/neovim3/bin/python"

  " if executable('hie')
    " au User lsp_setup call lsp#register_server({
        " \ 'name': 'hie',
        " \ 'cmd': {server_info->[&shell, &shellcmdflag, 'hie-wrapper --lsp']},
        " \ 'whitelist': ['haskell'],
        " \ })
  " endif
 

  " Vim GitGutter
  let g:signify_sign_add               = '┃'
  let g:signify_sign_delete            = '┃'
  let g:signify_sign_delete_first_line = '◥'
  let g:signify_sign_change            = '◢'
  let g:signify_sign_changedelete = g:signify_sign_change

  " noremap <Space>ghs :GitGutterStageHunk<cr>
  " noremap <Space>ghr :GitGutterUndoHunk<cr>
  " noremap <Space>ghv :GitGutterPreviewHunk<cr>

  "let g:completor_filetype_map = {}
  "let g:completor_filetype_map.haskell = {'ft': 'lsp', 'cmd': 'hie-wrapper'}

  " let g:LanguageClient_serverCommands = {
  " \ 'haskell': ['hie-wrapper']
  " \ }


  inoremap <expr> <CR> pumvisible() ? "\<C-y>" : "\<C-g>u\<CR>"
  inoremap <expr> <C-n> pumvisible() ? '<C-n>' :
    \ '<C-n><C-r>=pumvisible() ? "\<lt>Down>" : ""<CR>'
  
  inoremap <expr> <M-,> pumvisible() ? '<C-n>' :
    \ '<C-x><C-o><C-n><C-p><C-r>=pumvisible() ? "\<lt>Down>" : ""<CR>'

  " Uncomment the following line to disable relative number.
  " set norelativenumber

  " Adding extras.
  " Uncomment the following line If you have installed the powerline fonts.
  " It is good for airline layer.
  " let g:airline_powerline_fonts = 1

endfunction
